<p-toast [breakpoints]="{ '920px': { width: '100%', right: '0', left: '0' } }" />

@if (loadingtable) {
<div class="flex flex-col items-center justify-center text-center h-full p-4" style="background-color: transparent;">
    <div class="custom-spinner mb-4"></div>
</div>
}

@if (!loadingtable) {
<div class="custom-container">
    <p-panel class="transparente">

        <ng-template pTemplate="header">
            <div class="header-container title-header gap-2">
                <span>Permisos de {{ nombreRol }}</span>
            </div>
        </ng-template>
        <br>

        <p-table #dt [value]="permisos" [paginator]="true" columnResizeMode="expand" showGridlines
            [tableStyle]="{ 'min-width': '50rem' }" [rows]="5" [rowsPerPageOptions]="[5, 15, 25]" dataKey="id"
            [globalFilterFields]="['idObjeto','objeto','descripcion']">

            <ng-template pTemplate="caption">
                <div class="toolbar">
                    <!-- Botones a la izquierda -->
                    <div class="centraciones">
                        <!-- Contenedor de los botones a la izquierda -->
                        <div class="left-buttons">
                            <p-button label="Regresar" icon="pi pi-angle-double-left" variant="text"
                                styleClass="btn fw-bolder custom-1" raised text [routerLink]="['/seguridad/rol']">
                            </p-button>
                        </div>
                        <!-- Contenedor de los botones a la derecha -->
                        <div class="right-search">
                            <p-button label="Limpiar" icon="pi pi-filter-slash" [outlined]="true"
                                styleClass="btn custom-slash" class="responsive" (click)="clear(dt)" />

                            <p-iconField iconPosition="right">
                                <p-inputIcon class="pi pi-search" />
                                <input pInputText type="text" class="custom-search-input" placeholder="Buscar permiso"
                                    (input)="applyFilterGlobal($event, dt)" />
                            </p-iconField>
                        </div>
                    </div>
                </div>
            </ng-template>

            <ng-template pTemplate="header">
                <tr>
                    <th class="centered-header" style="min-width: 6rem">
                        <div class="flex items-center">
                            NÂ°
                            <p-columnFilter type="text" field="numero" display="menu" />
                        </div>
                    </th>
                    <th class="centered-header" style="min-width: 15rem">
                        <div class="flex items-center">
                            Pantalla
                            <p-columnFilter type="text" field="objeto" display="menu"></p-columnFilter>
                        </div>
                    </th>

                    <th class="centered-header" style="min-width: 12rem">
                        <div class="flex items-center">
                            Autorizado

                        </div>
                    </th>
                    <th class="centered-header" style="min-width: 12rem">
                        <div class="flex items-center">
                            Insertar

                        </div>
                    </th>
                    <th class="centered-header" style="min-width: 12rem">
                        <div class="flex items-center">
                            Eliminar

                        </div>
                    </th>
                    <th class="centered-header" style="min-width: 12rem">
                        <div class="flex items-center">
                            Actualizar

                        </div>
                    </th>
                    <th class="centered-header" style="min-width: 12rem">
                        <div class="flex items-center">
                            Consultar

                        </div>
                    </th>

                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-permiso>
                <tr>
                    <td class="centered-cell">{{ permiso.numero }}</td>
                    <td class="centered-cell">{{ permiso.objeto }}</td>

                    <td class="centered-cell">
                        <p-toggleswitch [(ngModel)]="permiso.permisoAutorizado"
                            (ngModelChange)="onPermissionChange(permiso, 'permisoAutorizado')" />
                    </td>
                    <td class="centered-cell">
                        <p-toggleswitch [(ngModel)]="permiso.permisoInsertar"
                            (ngModelChange)="onPermissionChange(permiso, 'permisoInsertar')" />
                    </td>
                    <td class="centered-cell">
                        <p-toggleswitch [(ngModel)]="permiso.permisoEliminar"
                            (ngModelChange)="onPermissionChange(permiso, 'permisoEliminar')" />
                    </td>
                    <td class="centered-cell">
                        <p-toggleswitch [(ngModel)]="permiso.permisoActualizar"
                            (ngModelChange)="onPermissionChange(permiso, 'permisoActualizar')" />
                    </td>
                    <td class="centered-cell">
                        <p-toggleswitch [(ngModel)]="permiso.permisoConsultar"
                            (ngModelChange)="onPermissionChange(permiso, 'permisoConsultar')" />
                    </td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">

                <tr>
                    <td colspan="7" class="centered-cell">
                        No se encontraron datos.
                    </td>
                </tr>
            </ng-template>

        </p-table>
        <br>

    </p-panel>
</div>
}